# Mongo 面试题

### MongoDB成为最好NoSQL数据库的原因是什么?

以下特点使得MongoDB成为最好的NoSQL数据库：

- 面向文件的
- 高性能
- 高可用性
- 易扩展性
- 丰富的查询语言

### MongoDB中的“Namespace”是什么?

MongoDB在集合中存储BSON(二进制交换和结构对象表示法)对象。**集合名称和数据库名称**的连接称为命名空间。

### MongoDB中的分片是什么?

跨多台机器存储数据记录的过程称为分片。它是一种MongoDB方法，以满足数据增长的需求。它是数据库或搜索引擎中的数据的水平分区。每个分区都称为切分或数据库切分。

### 在MongoDB中创建模式时，需要考虑哪些要点?

有几点需要考虑

- 根据用户需求设计模式
- 如果将对象组合在一起使用，则将它们组合到一个文档中。否则,将其分开
- 连接是在写的时候进行的，而不是在读取的时候进行的
- 对于大多数常见的用例，优化您的架构模式
- 在架构中进行复杂聚合

### 在MongoDB中创建集合和删除集合的语法是什么?

在MongoDB中创建集合的语法是db.createCollection(名称、选项)

在MongoDB中删除集合的语法是db.collection.drop()

### 解释分析器在MongoDB中的作用是什么？

MongoDB中包括了一个可以显示数据库中每个操作性能特点的数据库分析器。通过这个分析器你可以找到比预期慢的查询(或写操作);利用这一信息，比如，可以确定是否需要添加索引。

### 简要说明你能移动moveChunk目录下的旧文件吗?

是的，可以移动moveChunk目录中的旧文件，在正常的碎片操作期间，这些文件作为备份，一旦操作完成就可以删除。

### 为了进行安全备份，您可以使用MongoDB的哪些特性?

日志是MongoDB中可用于执行安全备份的功能。

### 说明Objecld由什么组成?

Objectld由

- 时间戳
- 客户机ID
- 客户端进程ID
- 3字节递增计数器

### 简要说明如何检查函数的源代码?

检查函数的源代码，不带任何括号，必须调用该函数。

### 什么是命令语法，告诉您是否在主服务器上？MongoDB允许多少个master？

命令语法Db.isMaster()将告诉您是否在主服务器上。MongoDB只允许一个主服务器，而couchDB允许多个主服务器。

### 解释一下MongoDB中的索引是什么?

索引是MongoDB中的特殊结构，它以易于遍历的形式存储一小部分数据集。索引按索引中**指定的字段的值排序**，存储特定字段或一组字段的值。

### 提到在MongoDB中使用索引的基本语法是什么?

MongoDB中使用的基本语法是>

`db.COLLECTION_NAME.ensureIndex ({KEY:1})。`

在这里，键是文档中出现的列(或KEY:VALUE对)的名称。

### 解释一下什么是MongoDB中的GridFS ?

为了**存储和检索大文件**，例如图像，视频文件和音频文件，使用GridFS。默认情况下，它使用**两个文件fs.files和fs.chunks来存储文件**的元数据和块。

### MongoDB有哪些替代方案？

Cassandra, CouchDB, Redis, Riak, Hbase都是不错的选择。

### 允许空值null吗?

对于对象成员而言，是的。然而用户不能够添加空值(null)到数据库丛集(collection)因为空值不是对象。然而用户能够添加空对象{}。

### 更新操作立刻fsync到磁盘?

不会，磁盘写操作默认是延迟执行的。写操作可能在两三秒(默认在60秒内)后到达磁盘。例如，如果一秒内数据库收到一千个对一个对象递增的操作，仅刷新磁盘一次。(注意，尽管fsync选项在命令行和经过getLastError_old是有效的)

### 如何执行事务/加锁?

MongoDB没有使用传统的锁或者复杂的带回滚的事务，因为它设计的宗旨是轻量，快速以及可预计的高性能。**可以把它类比成MySQL MylSAM的自动提交模式。**通过精简对事务的支持，性能得到了提升，特别是在一个可能会穿过多个服务器的系统里。

###  为什么我的数据文件如此庞大?

MongoDB会积极的预分配预留空间来防止文件系统碎片

### 什么是master或primary?

它是当前备份集群(replica set)中负责处理所有写入操作的主要节点/成员。在一个备份集群中，当失效备援(failover)事件发生时，一个另外的成员会变成primary。

### 什么是secondary或slave?

Seconday从当前的primary上复制相应的操作。它是通过跟踪复制oplog(local.oplog.rs)做到的。

### 我必须调用getLastError来确保写操作生效了么?

不用。不管你有没有调用getLastError(又叫"Safe Mode")服务器做的操作都一样。**调用getLastError只是为了确认写操作成功提交了**。当然，你经常想得到确认，但是写操作的安全性和是否生效不是由这个决定的。

### 数据在什么时候才会扩展到多个分片(shard)里?

MongoDB 分片是基于区域(range)的。所以一个集合(collection)中的所有的对象都被存放到一个块(chunk)中。只有当存在多于一个块的时候，才会有多个分片获取数据的选项。现在，每个默认块的大小是 64Mb，所以你需要至少 64 Mb 空间才可以实施一个迁移。

### 当我试图更新一个正在被迁移的块(chunk)上的文档时会发生什么?

更新操作会立即发生在旧的分片(shard)上，然后更改才会在所有权转移(ownership transfers)前复制到新的分片上。

### 如果块移动操作(moveChunk)失败了，我需要手动清除部分转移的文档吗?

不需要，移动操作是一致(consistent)并且是确定性的(deterministic);一次失败后，移动操作会不断重试;当完成后，数据只会出现在新的分片里(shard)。